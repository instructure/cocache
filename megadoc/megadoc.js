!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.megadoc=t():e.megadoc=t()}(this,function(){return webpackJsonp_megadoc([1],{0:function(e,t,n){"use strict";function o(e){console.log("megadoc: version %s",e.version);var t=v({strict:!0,verbose:!1}),o=g({database:e.database||[],redirect:e.redirect}),r={corpus:o};u.register(h.CFG_COLOR_SCHEME,h.DEFAULT_SCHEME),u.register(h.CFG_SIDEBAR_WIDTH,h.INITIAL_SIDEBAR_WIDTH),r.outlets=t,r.outlets.define("Meta"),r.outlets.define("LayoutWrapper"),r.outlets.define("Layout"),r.outlets.define("Layout::Banner"),r.outlets.define("Layout::Content"),r.outlets.define("Layout::Sidebar"),r.outlets.define("Layout::NavBar"),r.outlets.define("Layout::SidebarHeader"),r.outlets.define("Layout::Footer"),r.outlets.define("Inspector"),r.outlets.define("Image"),r.outlets.define("Link"),r.outlets.define("Text"),n(146)(r),n(144)(r),n(145)(r),n(147)(r),console.log("Firing up."),console.log("Loading %d external plugins.",e.plugins.length);var i={corpus:o};e.plugins.forEach(function(e){var n=o.getNamespacesForPlugin(e.name).map(function(e){return e.config});e.register&&e.register(i,n),e.outlets&&e.outlets.forEach(function(e){"string"==typeof e&&t.define(e)}),e.outletOccupants&&e.outletOccupants.forEach(function(e){t.add(e.name,{key:e.key||"default",component:e.component})})});var s=f(e,["database","plugins","startingDocumentUID","startingDocumentHref","pluginConfigs"]),a=p(e);return{appConfig:s,appState:a,outlets:t,corpus:o}}function r(e,t){return e?location.pathname.replace(e.meta.href,""):t?location.pathname.replace(t,""):""}var i=n(1),s=n(12),a=s.render,c=n(240),l=c.renderToString,u=n(47),p=n(88),h=n(36),d=n(148),m=n(10),f=m.omit,g=n(29),y=n(15),v=y.OutletManager;t.createClient=function(e){var t=o(e);return{render:function(e,n){n(null,l(i.createElement(d,{config:t.appConfig,appState:t.appState,corpus:t.corpus,outletManager:t.outlets,location:{protocol:"file:",origin:"file://",pathname:e.replace(/^#/,""),hash:""}})))}}},t.startApp=function(e){var t=o(e),n=r(t.corpus.get(e.startingDocumentUID),e.startingDocumentHref);console.log('Mount path = "%s".',n),a(i.createElement(d,{config:Object.assign({},t.appConfig,{mountPath:n}),appState:t.appState,corpus:t.corpus,outletManager:t.outlets,location:window.location}),document.querySelector("#__app__"))}},44:function(e,t,n){"use strict";function o(e){var t=e.config,n=e.corpus,o=e.documentURI;this.corpus=n,this.config=t,this.documentURI=o}function r(e,t){if(t&&t.meta&&t.meta.redirect){var n=i(e.corpus,t.meta.redirect);return n?n:(console.warn("Unable to find the redirect document target at '%s' (from '%s')",n.meta.redirect,t.uid),null)}return t}function i(e,t){return e.get(t)||e.getByURI(t)}function s(e){var t={};return"DocumentEntity"===e.type?(t.documentEntityNode=e,t.documentNode=e.parentNode,t.namespaceNode=a.getNamespaceOfNode(e)):"Document"===e.type?(t.documentNode=e,t.namespaceNode=a.getNamespaceOfNode(e)):"Namespace"===e.type&&(t.namespaceNode=e),t}var a=n(29),c=n(17),l=n(76);o.prototype.resolveFromLocation=function(e){var t=this.config,n=this.corpus,o=void 0;c("string"==typeof e.pathname,"Location @pathname must be present."),c("string"==typeof e.origin,"Location @origin must be present."),c("string"==typeof e.protocol,"Location @protocol must be present."),c("string"==typeof e.hash,"Location @hash must be present.");var a=this.getProtocolAgnosticPathName(e);if(t&&t.layoutOptions){var u=l.getDocumentOverride(a,t.layoutOptions);u&&(o=i(n,u),o||console.warn("A document '%s' specified as an override for the url '%s' could not be found. This is most likely a configuration error.",u,a))}if(o||(o=n.getByURI(a)),o)return s(r(this,o));var p=e.pathname+"index",h=this.documentURI.withExtension(p)+e.hash,d=n.getByURI(h);return d?s(r(this,d)):this.config.redirect[e.pathname]?this.resolveFromLocation(Object.assign({},e,{pathname:this.config.redirect[e.pathname]})):(console.warn("Unable to find a document at the URI '%s' (from '%s')",a,e.pathname),null)},o.prototype.getProtocolAgnosticPathName=function(e){return this.documentURI.normalize(this.documentURI.withExtension(e.pathname))+e.hash},e.exports=o,e.exports.buildDocumentContext=s},48:function(e,t,n){"use strict";var o=n(1).PropTypes,r=o.shape,i=o.string,s=o.func,a=o.oneOf;e.exports=r({pathname:i,origin:i,protocol:a(["file:","http:","https:"]),hash:i,replace:s})},76:function(e,t,n){"use strict";function o(e,t){return t?t.filter(function(t){return c(t.hasOwnProperty("match"),"A custom layout must have a @match property defined!"),s(t,e)})[0]:null}function r(e,t){var n=o(e,t);if(n)return n.regions}function i(e){return Array.isArray(e)?e:[].concat(e||[])}function s(e,t){var n=t.documentNode,o=t.namespaceNode,r=t.pathname,s=e.match.by,c=i(e.match.on);return"type"===s&&(n&&c.indexOf(n.type)>-1||o&&c.indexOf(o.type)>-1)||n&&"uid"===s&&c.indexOf(n.uid)>-1||"url"===s&&a(c,r)||"namespace"===s&&o&&c.indexOf(o.uid)>-1}function a(e,t){var n=t.split("#")[0];return e.some(function(e){return"*"===e||n.match(e)})}var c=n(17);t.getDocumentOverride=function(e,t){if(t.customLayouts){var n=o({pathname:e},t.customLayouts);if(n&&n.using)return n.using}},t.match=s,t.getRegionsForDocument=r},133:function(e,t,n){"use strict";function o(e,t){function n(e,t){var n=a({},e,{pathname:t.pathname}),r=c(n,t.customLayouts)||s(n)||l();return r.map(function(t){return o(t,e,n)})}function o(e,t,n){return e.outlets?a({},e,{outlets:e.outlets.filter(function(e){return!e.match||i.match(e,n)}).map(function(e){return a({},e,{scope:u(e,t)})})}):e}function s(e){var t=e.namespaceNode;if(t&&t.meta.defaultLayouts)return c(e,t.meta.defaultLayouts)}function l(){return[{name:"Layout::Content",outlets:null}]}function u(t,n){var o=void 0;if(t.using){var i=e.get(t.using);i&&(o=r.buildDocumentContext(i))}return"fixate"===t.injectionStrategy?o||n:a({},n,o)}var p=t.layoutOptions;return function(e,t){var o=n(e,{pathname:t,customLayouts:p.customLayouts});return{regions:o,hasSidebarElements:o.some(function(e){return"Layout::Sidebar"===e.name})}}}var r=n(44),i=n(76),s=n(10),a=s.assign,c=i.getRegionsForDocument;e.exports=o},134:function(e,t,n){"use strict";function o(e,t){return"A"===t.tagName&&a(e,t)}var r=n(1),i=n(12),s=i.findDOMNode,a=n(38),c=n(135),l=n(15),u=l.Outlet,p=l.OutletRenderer,h=n(10),d=h.debounce,m=r.PropTypes,f=r.createClass({displayName:"Inspector",propTypes:{inSinglePageMode:m.bool,isOutletOccupied:m.func.isRequired},getInitialState:function(){return{element:null}},componentDidMount:function(){this.debouncedShowTooltip=d(this.showTooltip,10),this.debouncedHideTooltip=d(this.hideTooltip,10),window.addEventListener("mouseover",this.debouncedShowTooltip,!1),window.addEventListener("mouseout",this.debouncedHideTooltip,!1)},componentWillUnmount:function(){window.removeEventListener("mouseout",this.debouncedHideTooltip,!1),window.removeEventListener("mouseover",this.debouncedShowTooltip,!1)},render:function(){if(!this.state.element)return null;var e=this.inspectElement(this.props.corpus,this.state.element);return e?r.createElement(c,{target:this.state.element},e):null},showTooltip:function(e){if(o(this.getContainerDOMNode(),e.target))this.state.element!==e.target&&this.setState({element:e.target});else{if(e.target===s(this))return;this.state.element&&this.setState({element:null})}},hideTooltip:function(e){e.target===this.state.element&&this.setState({element:null})},getContainerDOMNode:function(){return this.props.inSinglePageMode?document.querySelector(".single-page-layout__content"):document.querySelector(".two-column-layout__right")||document.querySelector(".root__screen")},inspectElement:function(e,t){var n=decodeURIComponent(t.href.replace(location.origin,"")),o=e.getByURI(n);if(o){var i={documentNode:o,namespaceNode:e.getNamespaceOfDocument(o)};if(this.props.isOutletOccupied({name:"Inspector",elementProps:i}))return r.createElement(u,{name:"Inspector",elementProps:i})}}});e.exports=p(f)},135:function(e,t,n){"use strict";var o=n(1),r=o.PropTypes,i=r.instanceOf,s=r.node,a=o.createClass({displayName:"InspectorTooltip",propTypes:{target:i(window.Element).isRequired,children:s.isRequired},getInitialState:function(){return{top:0,left:0}},componentDidMount:function(){this.computePositions(this.props.target)},componentWillUpdate:function(e){e.target!==this.props.target&&this.computePositions(e.target)},render:function(){return o.createElement("div",{style:this.state,className:"tooltip",children:this.props.children})},computePositions:function(e){var t=e.getBoundingClientRect(),n=t.top,o=t.left;n+=t.height,n===this.state.top&&o===this.state.left||this.setState({top:n,left:o})}});e.exports=a},136:function(e,t,n){"use strict";var o=n(1),r=n(13),i=n(137),s=n(140),a=n(96),c=o.PropTypes,l=c.node,u=c.shape,p=c.string,h=c.arrayOf,d=c.array,m=c.object,f=c.bool,g=u({text:p,href:p,links:d}),y=o.createClass({displayName:"Layout",contextTypes:{appState:m.isRequired},propTypes:{children:l,pathname:p.isRequired,template:u({regions:d,hasSidebarElements:f}).isRequired,scope:u({documentNode:m,documentEntityNode:m,namespaceNode:m}),banner:f,fixedSidbar:f,bannerLinks:h(g)},getDefaultProps:function(){return{banner:!0,fixedSidbar:!0,bannerLinks:[]}},componentWillUpdate:function(e){this.context.appState.inSinglePageMode()||e.scope.documentNode!==this.props.scope.documentNode&&a()},render:function(){var e=this.props.template,t=this.props,n=r({root:!0,"root--with-multi-page-layout":!0,"root--with-fixed-sidebar":t.fixedSidbar,"root--with-two-column-layout":e.hasSidebarElements,"root--with-banner":t.banner,"root--without-banner":!t.banner});return o.createElement("div",{className:n},t.banner&&o.createElement(i,{links:t.bannerLinks||[],currentPath:this.props.pathname}),o.createElement(s,e))}});e.exports=y},137:function(e,t,n){"use strict";var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=n(1),i=n(28),s=n(15),a=s.Outlet,c=n(18),l=n(35),u=n(22),p=n(138),h=n(139),d=r.PropTypes,m=d.string,f=d.any,g=d.arrayOf,y=d.object,v=r.PropTypes,S={motto:v.string,title:v.string,spotlight:v.bool,showSettingsLinkInBanner:v.bool},b=r.createClass({displayName:"Banner",statics:{BannerItem:p},propTypes:{children:f,currentPath:m,links:g(y),config:v.shape(S)},contextTypes:{appState:v.object.isRequired,documentURI:v.instanceOf(u).isRequired},render:function(){var e=this.props.config;return r.createElement("div",{className:"banner-wrapper"},r.createElement("header",{className:"banner"},r.createElement("h1",{className:"banner__logo"},r.createElement(i,{href:"/index.html"},e.title||"megadoc")," ",e.motto&&e.motto.length>0&&r.createElement("span",{className:"banner__motto"},e.motto),this.props.children),r.createElement("nav",{className:"banner__navigation"},e.spotlight&&r.createElement(p,{key:"spotlight",onClick:this.toggleSpotlight,title:"Quick-Jump (Ctrl+K or CMD+K)"},r.createElement(c,{className:"icon-search"})),r.createElement(a,{name:"MultiPageLayout::Banner",alwaysRenderChildren:!0,tagName:"span",fnRenderElement:function(e,t,n){return r.createElement(p,{key:e},r.createElement(n,t))}},e.showSettingsLinkInBanner&&r.createElement(p,{key:"settings"},r.createElement(i,{href:"/settings.html"},r.createElement(c,{className:"icon-cog"}))),this.props.links.map(this.renderLink)))))},renderLink:function(e){return e.links?r.createElement(p,{key:e.text},r.createElement(h,o({currentPath:this.props.currentPath},e))):r.createElement(p,{key:e.text},r.createElement(i,{href:this.context.documentURI.withExtension(e.href)},e.text))},toggleSpotlight:function(){this.context.appState.isSpotlightOpen()?this.context.appState.closeSpotlight():this.context.appState.openSpotlight()}});e.exports=l(b,S)},138:function(e,t,n){"use strict";var o=n(1),r=o.PropTypes,i=r.node,s=r.func,a=r.string,c=o.createClass({displayName:"BannerItem",propTypes:{children:i,onClick:s,title:a},render:function(){return o.createElement("div",{className:"banner__navigation-item",children:this.props.children,onClick:this.props.onClick,title:this.props.title})}});e.exports=c},139:function(e,t,n){"use strict";var o=n(1),r=n(28),i=n(18),s=n(13),a=n(22),c=o.PropTypes,l=c.string,u=c.oneOf,p=c.arrayOf,h=c.shape,d=o.createClass({displayName:"BannerMenu",propTypes:{currentPath:l,openStrategy:u(["hover","click"]),text:l.isRequired,href:l,links:p(h({text:l.isRequired,href:l.isRequired})).isRequired},contextTypes:{documentURI:o.PropTypes.instanceOf(a).isRequired},getDefaultProps:function(){return{openStrategy:"hover"}},getInitialState:function(){return{clicked:!1,hovering:!1}},componentWillUpdate:function(e){e.currentPath!==this.props.currentPath&&this.state.clicked&&this.close()},render:function(){var e=this,t="click"===this.props.openStrategy?this.state.clicked:this.state.hovering,n=this.props.links.some(function(t){return e.props.currentPath===t.href}),a=o.createElement(i,{className:"icon-arrow-down"});return o.createElement("div",{onMouseEnter:this.trackCursorOn,onMouseLeave:this.trackCursorOff,className:s("banner__menu",{"banner__menu--open":t,"banner__menu--active":n})},o.createElement("span",{className:"banner__menu-title",onClick:this.toggle},this.props.href?o.createElement(r,{href:this.context.documentURI.withExtension(this.props.href),active:n},this.props.text," ",a):o.createElement("span",null,this.props.text," ",a)),t&&o.createElement("ul",{className:"banner__menu-list"},this.props.links.map(this.renderLink)))},renderLink:function(e){return o.createElement("li",{key:e.href+e.text,className:"banner__menu-list-item"},o.createElement(r,{href:this.context.documentURI.withExtension(e.href)},e.text))},trackCursorOn:function(){this.state.hovering||this.setState({hovering:!0})},trackCursorOff:function(){this.state.hovering&&this.setState({hovering:!1})},toggle:function(){this.setState({clicked:!this.state.clicked})},close:function(){this.setState({clicked:!1})}});e.exports=d},140:function(e,t,n){"use strict";var o=n(1),r=n(87),i=n(83),s=n(78),a=n(45),c=n(79),l=n(86),u=n(35),p=n(15),h=p.OutletRenderer,d=p.Outlet,m=o.PropTypes,f={collapsibleSidebar:m.bool,footer:m.string,resizableSidebar:m.bool},g=o.createClass({displayName:"LayoutScreen",propTypes:{hasSidebarElements:m.bool,isOutletDefined:m.func,regions:m.arrayOf(m.shape({name:m.string.isRequired,options:m.object,outlets:m.arrayOf(m.shape({name:m.string,options:m.object,using:m.string,scope:m.shape({documentEntityNode:m.object,documentNode:m.object,namespaceNode:m.object})}))})).isRequired,config:m.shape(f)},render:function(){return o.createElement("div",{className:"root__screen"},this.props.hasSidebarElements?this.renderTwoColumnLayout():this.renderSingleColumnLayout())},renderTwoColumnLayout:function(){var e=this.renderNavBar(),t=this.props.config;return o.createElement(r,{resizable:t.resizableSidebar,collapsible:t.collapsibleSidebar},o.createElement(r.LeftColumn,null,o.createElement("div",null,this.renderRegion("Layout::Sidebar"))),o.createElement(r.RightColumn,null,this.renderContent()),e&&o.createElement(r.NavColumn,null,e))},renderSingleColumnLayout:function(){return this.renderContent()},renderContent:function(){var e=this.getOutletTag("Layout::Content");return o.createElement("div",null,o.createElement(e,null,this.renderRegion("Layout::Content")||o.createElement(i,null)),o.createElement(c,null,this.props.config.footer))},renderNavBar:function(){var e=this.renderRegion("Layout::NavBar");if(!e)return null;var t=this.getOutletTag("Layout::NavBar");return o.createElement(l,null,o.createElement(t,null,o.createElement("p",null,"Contents"),this.renderRegion("Layout::NavBar")))},renderRegion:function(e){var t=this,n=this.props.regions.filter(function(t){return t.name===e})[0];return n&&n.outlets?n.outlets.map(function(e,r){var i=e.scope,s=e.name+"__"+r;return t.props.isOutletDefined(e.name)?i?o.createElement(d,{key:s,name:e.name,options:e.options,elementProps:i}):o.createElement(a,{key:s},o.createElement("p",null,'No document was found with the UID "',e.using,'" to be inserted into the outlet "',e.name,'" of the region "',n.name,'". This is most likely a configuration error.')):o.createElement(a,{key:s},o.createElement("p",null,'Outlet "',e.name,'" has not been defined! This is most likely a configuration error. Please verify the outlet name is correct.'))}).filter(function(e){return!!e}):null},getOutletTag:function(e){var t=this.props.regions.filter(function(t){return t.name===e})[0];return t&&t.options&&t.options.framed?s:"div"}});e.exports=h(u(g,f))},141:function(e,t,n){"use strict";function o(){var e=s.call(document.querySelectorAll("[id]"),function(e){return e.tagName.match(/^H\d/)}).map(function(e){return{node:e,box:e.getBoundingClientRect()}}),t=void 0,n=void 0;if(e.forEach(function(e){var o=Math.abs(e.box.top);void 0===n?(n=o,t=e):o<n&&(n=o,t=e)}),t){var o=t.node.id,r="#"+o;window.location.hash!==r&&(t.node.id=null,window.location.hash=r,t.node.id=o,i.refresh())}}var r=n(1),i=n(90),s=Array.prototype.filter,a=r.createClass({displayName:"ScrollSpy",getDefaultProps:function(){return{query:{},params:{}}},componentDidMount:function(){window.addEventListener("scroll",o,!1)},shouldComponentUpdate:function(){return!1},componentWillUnmount:function(){window.removeEventListener("scroll",o,!1)},render:function(){return null}});e.exports=a},142:function(e,t,n){"use strict";var o=n(1),r=n(12),i=r.findDOMNode,s=n(10),a=s.debounce,c=n(92),l=n(28),u=n(37),p=o.PropTypes,h=p.func,d=p.arrayOf,m=p.shape,f=p.string,g=p.bool,y="function"==typeof window.Element.prototype.scrollIntoViewIfNeeded,v=d(m({$1:f,$2:f,$3:f,link:m({href:f})})),S=o.createClass({displayName:"Spotlight",statics:{MAX_RESULTS:15},propTypes:{onActivate:h,corpus:v,symbols:v,startInSymbolMode:g},getInitialState:function(){return{results:[],lastSearchTerm:"",cursor:0}},componentWillMount:function(){this.debouncedSearch=a(this.search,13),this.corpusSearcher=c(this.props.corpus),this.buildSymbolSearcher(this.props.symbols)},componentDidMount:function(){if(this.props.startInSymbolMode){var e=i(this.refs.editingWidget);e.value="@",this.search("@")}},componentWillUpdate:function(e){e.symbols!==this.props.symbols&&this.buildSymbolSearcher(e.symbols)},componentDidUpdate:function(e,t){t.cursor!==this.state.cursor&&this.scrollSelectedIntoView()},render:function(){var e=this.state.results,t=this.state.lastSearchTerm.match(/^@/),n="@"===this.state.lastSearchTerm,r=this.getNavigatableResults();return o.createElement("div",{className:"spotlight__wrapper"},o.createElement("div",{className:"spotlight"},o.createElement("div",{className:"spotlight__help"},o.createElement("span",null,t?"Jump to a symbol":"Jump to a document"),o.createElement("div",{className:"float--right"},o.createElement("div",{className:"spotlight__help-entry"},o.createElement("strong",null,"tab")," or ",o.createElement("strong",null,"â†‘"),o.createElement("strong",null,"â†“")," to navigate")," ",o.createElement("div",{className:"spotlight__help-entry"},o.createElement("strong",null,"â†µ")," to select")," ",o.createElement("div",{className:"spotlight__help-entry"},o.createElement("strong",null,"esc")," to dismiss"))),o.createElement("input",{autoFocus:!0,type:"text",onChange:this.proxyToDebouncedSearch,className:"spotlight__input",onKeyDown:this.navigate,ref:"editingWidget"}),o.createElement("ul",{className:"spotlight__results",ref:"scrollableWidget"},!n&&0===e.length&&this.state.lastSearchTerm.length>0&&o.createElement("li",{className:"spotlight__result"},"Nothing matched your query. ðŸ˜ž"),n&&0===(this.props.symbols||[]).length&&o.createElement("li",{className:"spotlight__result"},"No symbols were found for this document. ðŸ˜ž"),r.map(this.renderResult))))},getNavigatableResults:function(){return"@"===this.state.lastSearchTerm?this.props.symbols||[]:this.state.results},renderResult:function(e,t){var n=e.link.href,r=e.$1;return o.createElement("li",{key:n+(e.link.anchor||""),className:u({spotlight__result:!0,"spotlight__result--active":this.state.cursor===t})},o.createElement(l,{href:n,anchor:e.link.anchor,ref:"link__"+t,onClick:this.props.onActivate},o.createElement("span",{dangerouslySetInnerHTML:{__html:r.replace(/^(\s+)/,function(e){return Array(e.length+1).join("&nbsp;&nbsp;")})}})," ",e.link.context&&o.createElement("em",{className:"spotlight__result-context"},e.link.context)))},buildSymbolSearcher:function(e){this.symbolSearcher=e?c(e):null},proxyToDebouncedSearch:function(e){this.debouncedSearch(e.target.value)},search:function(e){var t=e.match(/^@/)&&this.symbolSearcher?this.symbolSearcher.search(e.slice(1)):this.corpusSearcher.search(e).slice(0,S.MAX_RESULTS);this.setState({cursor:0,lastSearchTerm:e,results:t})},navigate:function(e){var t=e.keyCode,n=e.ctrlKey||e.metaKey;40===t?(e.preventDefault(),this.selectNext()):38===t?(e.preventDefault(),this.selectPrev()):35===t&&n?(e.preventDefault(),this.selectLast()):36===t&&n?(e.preventDefault(),this.selectFirst()):9===t?(e.preventDefault(),e.shiftKey?this.selectPrev():this.selectNext()):13===t&&(e.preventDefault(),this.activateSelected(),this.props.onActivate&&this.props.onActivate())},selectFirst:function(){var e=this.getNavigatableResults();e.length&&this.updateCursor(0)},selectNext:function(){var e=this.getNavigatableResults();e.length&&this.updateCursor(this.state.cursor<e.length-1?this.state.cursor+1:0)},selectPrev:function(){var e=this.getNavigatableResults();e.length&&this.updateCursor(this.state.cursor>0?this.state.cursor-1:e.length-1)},selectLast:function(){var e=this.getNavigatableResults();e.length&&this.updateCursor(e.length-1)},updateCursor:function(e){this.state.cursor!==e&&this.setState({cursor:e})},scrollSelectedIntoView:function(){if(y){var e=this.getSelectedDOMNode();e&&e.scrollIntoViewIfNeeded()}},activateSelected:function(){var e=this.getSelectedDOMNode();e&&e.click()},getSelectedDOMNode:function(){return i(this.refs["link__"+this.state.cursor])}});e.exports=S},143:function(e,t,n){"use strict";function o(e,t){return e.getDocumentEntitySearchIndex(t.uid)}function r(e,t){var n=e.getByURI(t);if(n)return o(e,n)}var i=n(1),s=n(12),a=s.findDOMNode,c=n(142),l=n(38),u=n(36),p=u.KC_ESCAPE,h=i.PropTypes,d=h.bool,m=h.func,f=h.object,g=h.string,y=n(22),v=i.createClass({displayName:"SpotlightManager",propTypes:{active:d.isRequired,onOpen:m.isRequired,onClose:m.isRequired,documentNode:f,pathname:g.isRequired},contextTypes:{documentURI:i.PropTypes.instanceOf(y).isRequired},getInitialState:function(){return{openedInSymbolMode:!1}},componentDidMount:function(){window.addEventListener("keydown",this.handleGlobalKeybindings,!0),this.props.active&&this.closeSpotlightOnExternalClicks()},componentDidUpdate:function(e,t){!e.active&&this.props.active?this.closeSpotlightOnExternalClicks():e.active&&!this.props.active&&this.stopClosingSpotlightOnExternalClicks(),t.openedInSymbolMode&&this.setState({openedInSymbolMode:!1})},componentWillUnmount:function(){window.removeEventListener("keydown",this.handleGlobalKeybindings,!0)},render:function(){var e=this.props.corpus;if(this.props.active){var t=this.props.documentNode?o(e,this.props.documentNode):r(e,this.context.documentURI.normalize(this.props.pathname));return i.createElement(c,{startInSymbolMode:this.state.openedInSymbolMode,corpus:e.getDocumentSearchIndex(),symbols:t,onActivate:this.closeSpotlight})}return null},openSpotlight:function(){this.props.onOpen()},closeSpotlight:function(){this.props.onClose()},handleGlobalKeybindings:function(e){var t=this,n=String.fromCharCode(e.which).toLowerCase(),o=e.ctrlKey||e.metaKey;"k"===n&&o?(e.preventDefault(),this.props.active?this.closeSpotlight():this.openSpotlight()):190===e.which&&o&&!this.props.active?(e.preventDefault(),this.setState({openedInSymbolMode:!0},function(){t.openSpotlight()})):e.which===p&&(e.preventDefault(),this.closeSpotlight())},closeSpotlightOnExternalClicks:function(){window.addEventListener("click",this.doCloseSpotlightOnExternalClicks,!1)},stopClosingSpotlightOnExternalClicks:function(){window.removeEventListener("click",this.doCloseSpotlightOnExternalClicks,!1)},doCloseSpotlightOnExternalClicks:function(e){l(e.target,a(this))&&this.closeSpotlight()}});e.exports=v},144:function(e,t,n){"use strict";var o=n(1),r=o.PropTypes,i=r.shape,s=r.string,a=n(50),c=o.createClass({displayName:"ImageOutlet",contextTypes:{location:i({pathname:s})},propTypes:{$outletOptions:i({src:s.isRequired}).isRequired},render:function(){return o.createElement("img",{src:a(this.props.$outletOptions.src,this.context.location.pathname)})}});e.exports=function(e){e.outlets.add("Image",{key:"Image",component:c})}},145:function(e,t,n){"use strict";var o=n(1),r=o.PropTypes,i=r.shape,s=r.string,a=n(28),c=o.createClass({displayName:"LinkOutlet",contextTypes:{location:i({pathname:s})},propTypes:{$outletOptions:i({href:s.isRequired,text:s.isRequired,title:s}).isRequired},render:function(){var e=this.props.$outletOptions;return o.createElement(a,{href:e.href,title:e.title,children:e.text})}});e.exports=function(e){e.outlets.add("Link",{key:"Link",component:c})}},146:function(e,t,n){"use strict";var o=n(1),r=n(85),i=o.PropTypes,s=i.shape,a=i.string,c=o.createClass({displayName:"SidebarHeaderOutlet",propTypes:{$outletOptions:s({text:a.isRequired})},render:function(){return o.createElement(r,null,this.props.$outletOptions.text)}});e.exports=function(e){e.outlets.add("Layout::SidebarHeader",{key:"xxx",component:c})}},147:function(e,t,n){"use strict";var o=n(1),r=o.PropTypes,i=r.shape,s=r.string,a=o.createClass({displayName:"TextOutlet",propTypes:{$outletOptions:i({tagName:s,className:s,text:s.isRequired,title:s}).isRequired},render:function(){var e=this.props.$outletOptions,t=e.tagName||"div";return o.createElement(t,{className:e.className,title:e.title,children:e.text})}});e.exports=function(e){e.outlets.add("Text",{key:"Text",component:a})}},148:function(e,t,n){"use strict";function o(e){function t(){var t=e.location,n=t.hash;n&&n.length>0&&t.replace(n)}var n=window,o=n.history,r=e.onChange,i={start:function(){window.addEventListener("hashchange",t),window.addEventListener("popstate",r),"/"===e.location.pathname&&i.transitionTo("/index.html")},transitionTo:function(e){return o.pushState(null,null,e),r(),!0},refreshScroll:t,stop:function(){window.removeEventListener("popstate",r),window.removeEventListener("hashchange",t)}};return i}function r(e){var t=e.onChange;return{start:function(){window.addEventListener("hashchange",t)},transitionTo:function(){},refreshScroll:function(){},stop:function(){window.removeEventListener("hashchange",t)}}}function i(e){var t=e.onChange;return{start:function(){window.addEventListener("hashchange",t)},transitionTo:function(t){"#"!==t[0]&&(0===t.indexOf(e.mountPath)?location.href=t:location.href=[e.mountPath,t].join("/").replace(/\/+/g,"/"))},refreshScroll:function(){},stop:function(){window.removeEventListener("hashchange",t)}}}function s(e){return 0===e.button}function a(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var c=n(1),l=n(149),u=n(22),p=n(44),h=n(15),d=h.OutletProvider,m=c.PropTypes,f=c.createClass({displayName:"App",propTypes:{appState:m.object.isRequired,config:m.object.isRequired,corpus:m.object.isRequired,location:n(48).isRequired},childContextTypes:{appState:m.object,corpus:m.object,documentResolver:m.instanceOf(p),documentURI:m.instanceOf(u)},getInitialState:function(){return{hashDisabled:!0}},getChildContext:function(){return{appState:this.props.appState,corpus:this.props.corpus,documentURI:this.documentURI,documentResolver:this.documentResolver}},componentWillMount:function(){var e=this.props.config;this.documentURI=new u({mountPath:"file:"===this.props.location.protocol?e.mountPath:null,extension:e.emittedFileExtension}),this.documentResolver=new p({config:e,corpus:this.props.corpus,documentURI:this.documentURI});var t=this.props.location.pathname.replace(e.mountPath,""),n=e.redirect[t],s=void 0;e.layoutOptions&&e.layoutOptions.singlePageMode?s=r:"file:"===this.props.location.protocol?s=i:this.props.location.protocol.match(/^https?:/)&&(s=o),this.locationAPI=s({mountPath:e.mountPath,location:this.props.location,onChange:this.reload}),this.locationAPI.start(),n&&this.locationAPI.transitionTo(n)},componentDidMount:function(){this.setState({hashDisabled:!1})},componentWillUnmount:function(){this.locationAPI.stop()},render:function(){var e=this.props.location;return c.createElement(d,{outletManager:this.props.outletManager},c.createElement(l,{onNavigate:this.navigate,onRefreshScroll:this.locationAPI.refreshScroll,config:this.props.config,corpus:this.props.corpus,appState:this.props.appState,location:{pathname:this.documentURI.normalize(e.pathname),hash:this.state.hashDisabled?"":e.hash,origin:e.origin,protocol:e.protocol}}))},reload:function(){console.debug("App: forcing update."),this.forceUpdate()},navigate:function(e,t){if(s(e)&&!a(e)){var n=t.href.replace(location.origin,"");this.locationAPI.transitionTo(n)&&(e.stopPropagation(),e.preventDefault())}}});e.exports=f},149:function(e,t,n){"use strict";function o(e){var t=e.href;return t&&"object"===("undefined"==typeof t?"undefined":r(t))?e.className.baseVal.indexOf("mega-link--internal")>-1?t.baseVal:void 0:t&&0===t.indexOf(location.origin)}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s=n(1),a=n(15),c=a.Outlet,l=n(47),u=n(143),p=n(134),h=n(136),d=n(141),m=n(44),f=n(22),g=n(133),y=n(45),v=s.PropTypes,S=v.object,b=v.func,E=s.createClass({displayName:"Root",childContextTypes:{config:S,location:n(48),navigate:b},propTypes:{appState:S.isRequired,config:S,corpus:S.isRequired,location:n(48),onNavigate:b,onRefreshScroll:b},contextTypes:{documentURI:s.PropTypes.instanceOf(f).isRequired,documentResolver:s.PropTypes.instanceOf(m).isRequired},getChildContext:function(){return{location:this.props.location,config:this.props.config,navigate:this.props.onNavigate}},componentWillMount:function(){this.realizeTemplate=g(this.props.corpus,this.props.config)},componentDidMount:function(){l.on("change",this.reload),this.props.appState.on("change",this.reload),window.addEventListener("click",this.handleInternalLink,!1)},componentDidUpdate:function(e){e.location.hash!==this.props.location.hash&&(console.debug('Hash has changed from "%s" to "%s" - forcing refresh!',e.location.hash,this.props.location.hash),this.props.onRefreshScroll())},componentWillUnmount:function(){this.realizeTemplate=null,window.removeEventListener("click",this.handleInternalLink,!1),this.props.appState.off("change",this.reload),l.off("change",this.reload)},render:function(){var e=this.props.config,t=this.getPathName(),n=void 0,o=void 0;return this.props.appState.inSinglePageMode()||(n=this.resolveCurrentDocument())?(o=this.realizeTemplate(n,this.getPathName()),s.createElement(c,{name:"LayoutWrapper",forwardChildren:!0},s.createElement(c,{name:"Meta"}),e.tooltipPreviews&&s.createElement(p,{corpus:this.props.corpus,inSinglePageMode:e.layoutOptions&&e.layoutOptions.singlePageMode}),e.spotlight&&s.createElement(u,{corpus:this.props.corpus,active:this.props.appState.isSpotlightOpen(),onOpen:this.props.appState.openSpotlight,onClose:this.props.appState.closeSpotlight,documentNode:n&&n.documentNode,pathname:t}),e.scrollSpying&&s.createElement(d,null),s.createElement(h,i({},e.layoutOptions,{pathname:t,scope:n,template:o})))):this.renderInternalError()},renderInternalError:function(){return s.createElement(y,{style:{width:"50vw",margin:"10vh auto 0 auto"}},s.createElement("p",null,"There was no document found at this URL. This most likely indicates a configuration error. Please check and try again."),s.createElement("p",null,"Debugging information:"),s.createElement("pre",null,"Corpus size: ",this.props.corpus.length,"\n","Location: ",JSON.stringify(this.getLocation(),null,2)));
},reload:function(){console.debug("Root: updating"),this.forceUpdate()},handleInternalLink:function(e){var t=e.target;"A"!==t.tagName&&"a"!==t.tagName||!o(t)||this.props.onNavigate(e,{href:t.getAttribute("href")})},resolveCurrentDocument:function(){return this.context.documentResolver.resolveFromLocation(this.getLocation(),this.props.config)},getPathName:function(){return this.context.documentResolver.getProtocolAgnosticPathName(this.getLocation(),this.context.documentURI)},getLocation:function(){return this.props.location}});e.exports=E},200:function(e,t,n){"use strict";var o=n(109),r=n(214),i=n(118);o.inject();var s={renderToString:r.renderToString,renderToStaticMarkup:r.renderToStaticMarkup,version:i};e.exports=s},213:function(e,t){"use strict";var n={isBatchingUpdates:!1,batchedUpdates:function(e){}};e.exports=n},214:function(e,t,n){"use strict";function o(e,t){var n;try{return m.injection.injectBatchingStrategy(h),n=d.getPooled(t),y++,n.perform(function(){var o=g(e,!0),r=p.mountComponent(o,n,null,c(),f,0);return t||(r=u.addChecksumToMarkup(r)),r},null)}finally{y--,d.release(n),y||m.injection.injectBatchingStrategy(l)}}function r(e){return a.isValidElement(e)?void 0:s("46"),o(e,!1)}function i(e){return a.isValidElement(e)?void 0:s("47"),o(e,!0)}var s=n(4),a=n(21),c=n(106),l=n(108),u=(n(8),n(114)),p=n(20),h=n(213),d=n(117),m=n(11),f=n(23),g=n(69),y=(n(2),0);e.exports={renderToString:r,renderToStaticMarkup:i}},240:function(e,t,n){"use strict";e.exports=n(200)}})});